- godot will attempt to load a .image file. Since squeak images share that extension,
  we need to put plugin files including the squeak file into a folder with a .gdignore file
- https://godotengine.org/article/look-gdnative-architecture
- godot does **not** load dependencies for you, normal rpath rules still apply

- Problem: How to call init_squeak_callbacks() from inside Squeak via FFI?
  - The squeak method that performs this call uses the pragma `<apicall: void init_squeak_callbacks()>`
  - If the class containing the method has the module 'sqplugin', the FFI call fails with 'Error: External module not found'.
    This makes sense because there is no libsqplugin.so that it could load.
    The shared library is already loaded anyway and shouldn't be loaded again.
  - If the class has the module '' (empty string) which triggers internal function resolution, the FFI call fails with 'Error: Unable to find function address'. So internal resolution has failed as well.
    - Excursion: How Smalltalk's internal function resolution works
      The VM will first try to get the module handle for the given module name.
      If the module name is either NULL or an empty string, it will resolve to the module handle of the main program.
      It will then try to find the internal function for that module.
      The function it uses for this is findInternalFunctionIn(char *functionName, char *pluginName, ...)
      For that purpose, there exists an (apparently autogenerated) file containing an array with an element for each internal module.
      Each element is another array with all the exported functions of its respective module.
      The VM will look through the items of the module with the matching name (in the case of the vm module, an empty string) and return the one that matches, or fail.
    - Aside: The VM entrypoint for FFI calls is primitiveCallout()
  - Possible Solutions:
    - Write a plugin for the VM that has a function that performs the callback initialization.
      That function would likely have to load the init_squeak_callbacks symbol with dlsym (is this possible?)
    - Write a shared library that is loaded by both sqPlugin and the VM that handles the initialization.
      This works because calling dlopen multiple times on the same library will always return the same handle.
      - wait -- why can't I just load sqPlugin from within Smalltalk a second time?
        - turns out, I can

- icons for classes and methods are determined in ToolIcons

- PluginScriptLanguage does not implement make_template. Due to further implementation details, this means that PluginScript scripts are not automatically loaded when they are created
- ResourceFormatSaverPluginScript does not reload scripts on save. There is an option for that, but it is only respected by the gdscript saver
  https://github.com/godotengine/godot/issues/19653
  - solution a: modify godot source
  - solution b: abuse the template generation function for that

- godot might allow property hinting, see godot_nativescript_register_property or the script manifest

- godot_variant_call returns a godot_variant on the stack. who owns it? do I need to destroy it?
